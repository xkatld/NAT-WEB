{% extends 'layout.html' %}

{% block content %}
<h2 class="mb-3">添加新 NAT 规则</h2> {# Add bottom margin #}

<form method="POST">
    {{ form.csrf_token }}

    {# Each form group div #}
    <div class="mb-3">
        {{ form.chain.label(class_="form-label") }} {# Add form-label class #}
        {{ form.chain(class_="form-select") }} {# Add form-select class for select #}
        {% for error in form.chain.errors %}
            <div class="invalid-feedback d-block">{{ error }}</div> {# Display errors with Bootstrap invalid feedback style #}
        {% endfor %}
    </div>

    <div class="mb-3">
        {{ form.protocol.label(class_="form-label") }}
        {{ form.protocol(class_="form-select") }}
        {% for error in form.protocol.errors %}
            <div class="invalid-feedback d-block">{{ error }}</div>
        {% endfor %}
    </div>

    <div class="mb-3">
        {{ form.source.label(class_="form-label") }}
        {{ form.source(class_="form-control") }} {# Add form-control class #}
        {% for error in form.source.errors %}
            <div class="invalid-feedback d-block">{{ error }}</div>
        {% endfor %}
    </div>

    <div class="mb-3">
        {{ form.destination.label(class_="form-label") }}
        {{ form.destination(class_="form-control") }}
        {% for error in form.destination.errors %}
            <div class="invalid-feedback d-block">{{ error }}</div>
        {% endfor %}
    </div>

    <div class="mb-3">
        {{ form.in_interface.label(class_="form-label") }}
        {{ form.in_interface(class_="form-control") }}
        {% for error in form.in_interface.errors %}
            <div class="invalid-feedback d-block">{{ error }}</div>
        {% endfor %}
    </div>

     <div class="mb-3">
        {{ form.out_interface.label(class_="form-label") }}
        {{ form.out_interface(class_="form-control") }}
        {% for error in form.out_interface.errors %}
            <div class="invalid-feedback d-block">{{ error }}</div>
        {% endfor %}
    </div>

    <div class="mb-3">
        {{ form.source_port.label(class_="form-label") }}
        {{ form.source_port(class_="form-control") }}
        {% for error in form.source_port.errors %}
            <div class="invalid-feedback d-block">{{ error }}</div>
        {% endfor %}
        <small class="form-text text-muted">需要选择非“任意”协议</small> {# Use small text with muted color #}
    </div>

    <div class="mb-3">
        {{ form.destination_port.label(class_="form-label") }}
        {{ form.destination_port(class_="form-control") }}
        {% for error in form.destination_port.errors %}
            <div class="invalid-feedback d-block">{{ error }}</div>
        {% endfor %}
        <small class="form-text text-muted">需要选择非“任意”协议</small>
    </div>

    <div class="mb-3">
        {{ form.target.label(class_="form-label") }}
        {{ form.target(class_="form-select") }}
        {% for error in form.target.errors %}
            <div class="invalid-feedback d-block">{{ error }}</div>
        {% endfor %}
    </div>

    <div class="mb-3">
        {{ form.to_destination.label(class_="form-label") }}
        {{ form.to_destination(class_="form-control") }}
        {% for error in form.to_destination.errors %}
            <div class="invalid-feedback d-block">{{ error }}</div>
        {% endfor %}
        <small class="form-text text-muted">(例如: 192.168.1.100:80, 仅用于 DNAT)</small>
    </div>

    <div class="mb-3">
        {{ form.to_source.label(class_="form-label") }}
        {{ form.to_source(class_="form-control") }}
        {% for error in form.to_source.errors %}
            <div class="invalid-feedback d-block">{{ error }}</div>
        {% endfor %}
         <small class="form-text text-muted">(例如: 1.2.3.4, 仅用于 SNAT/MASQUERADE)</small>
    </div>

    <div class="mb-3">
        {{ form.description.label(class_="form-label") }}
        {{ form.description(class_="form-control") }}
        {% for error in form.description.errors %}
            <div class="invalid-feedback d-block">{{ error }}</div>
        {% endfor %}
    </div>

    <button type="submit" class="btn btn-primary">
        <i class="fas fa-plus-circle me-1"></i> {{ form.submit.label.text }} {# Optional: Add icon if using Font Awesome/Bootstrap Icons #}
    </button>
    <a href="{{ url_for('index') }}" class="btn btn-secondary ms-2">取消</a> {# Secondary button with margin start #}

</form>

{% endblock %}
